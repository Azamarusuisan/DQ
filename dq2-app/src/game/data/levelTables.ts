import type { LevelTable, LevelEntry } from '../types';

// ============================================================
// Level Table Generation
// ============================================================

/**
 * Generate a level table for legacy characters.
 * @param hp0   - Base HP at level 1
 * @param mp0   - Base MP at level 1
 * @param str0  - Base STR at level 1
 * @param agi0  - Base AGI at level 1
 * @param hpG   - HP growth per level
 * @param mpG   - MP growth per level
 * @param strG  - STR growth per level
 * @param agiG  - AGI growth per level
 * @param spells - Array of [level, spellKey] pairs
 */
export function genLvTable(
  hp0: number, mp0: number, str0: number, agi0: number,
  hpG: number, mpG: number, strG: number, agiG: number,
  spells: [number, string][]
): LevelTable {
  return Array.from({ length: 99 }, (_, i) => {
    const lv = i + 1;
    const exp = Math.floor(lv * lv * lv * 0.8 + lv * lv * 30 + lv * 100);
    const sp = spells.filter(([l]) => l === lv).map(([, s]) => s);
    return [
      exp,
      hp0 + Math.floor(hpG * i),
      mp0 + Math.floor(mpG * i),
      str0 + Math.floor(strG * i),
      agi0 + Math.floor(agiG * i),
      sp,
    ] as LevelEntry;
  });
}

// ============================================================
// Hero (ローレシアの王子) Level Table - 99 levels
// ============================================================
export const HERO_LV: LevelTable = [
  [0,20,0,8,5,[]],[4,40,0,14,9,[]],[27,56,2,20,12,[]],[82,71,3,25,16,[]],
  [178,85,4,30,19,['gira']],[324,98,6,35,22,[]],[531,111,7,40,26,['begirama']],
  [804,124,8,44,29,[]],[1154,136,10,49,32,['ionazun']],[1585,149,11,54,36,[]],
  [2107,161,13,58,39,[]],[2726,173,14,63,42,['baikiruto']],[3447,184,16,67,45,[]],
  [4279,196,18,72,48,[]],[5227,207,19,76,51,[]],[6297,219,21,80,55,[]],
  [7496,230,23,85,58,[]],[8829,241,24,89,61,[]],[10302,252,26,93,64,[]],
  [11921,263,28,98,67,[]],[13692,274,30,102,70,[]],[15620,284,31,106,73,[]],
  [17711,295,33,110,76,[]],[19969,306,35,114,79,[]],[22401,316,37,119,83,[]],
  [25011,327,39,123,86,[]],[27805,337,41,127,89,[]],[30787,347,43,131,92,[]],
  [33964,358,44,135,95,[]],[37339,368,46,139,98,[]],[40918,378,48,143,101,[]],
  [44706,388,50,147,104,[]],[48707,398,52,151,107,[]],[52927,408,54,155,110,[]],
  [57370,418,56,159,113,[]],[62040,428,58,163,116,[]],[66943,438,60,167,119,[]],
  [72083,448,62,171,122,[]],[77465,458,64,175,125,[]],[83093,467,66,179,128,[]],
  [88972,477,68,183,131,[]],[95106,487,70,187,134,[]],[101499,496,72,191,137,[]],
  [108157,506,74,195,140,[]],[115083,516,77,199,143,[]],[122282,525,79,203,146,[]],
  [129758,535,81,206,149,[]],[137516,544,83,210,152,[]],[145560,554,85,214,155,[]],
  [153893,563,87,218,158,[]],[162521,573,89,222,161,[]],[171447,582,91,226,164,[]],
  [180675,591,93,230,167,[]],[190210,601,96,233,170,[]],[200057,610,98,237,172,[]],
  [210217,619,100,241,175,[]],[220697,628,102,245,178,[]],[231500,638,104,249,181,[]],
  [242630,647,107,252,184,[]],[254091,656,109,256,187,[]],[265888,665,111,260,190,[]],
  [278023,674,113,264,193,[]],[290501,683,115,268,196,[]],[303326,692,118,271,199,[]],
  [316501,702,120,275,202,[]],[330032,711,122,279,205,[]],[343921,720,124,283,208,[]],
  [358172,729,127,286,211,[]],[372789,738,129,290,213,[]],[387777,747,131,294,216,[]],
  [403139,755,134,298,219,[]],[418878,764,136,301,222,[]],[434998,773,138,305,225,[]],
  [451504,782,140,309,228,[]],[468398,791,143,312,231,[]],[485685,800,145,316,234,[]],
  [503369,809,147,320,237,[]],[521452,818,150,324,240,[]],[539939,826,152,327,242,[]],
  [558834,835,154,331,245,[]],[578139,844,157,335,248,[]],[597860,853,159,338,251,[]],
  [617998,861,161,342,254,[]],[638558,870,164,346,257,[]],[659544,879,166,349,260,[]],
  [680959,887,169,353,263,[]],[702806,896,171,357,266,[]],[725089,905,173,360,268,[]],
  [747813,913,176,364,271,[]],[770979,922,178,367,274,[]],[794592,931,181,371,277,[]],
  [818656,939,183,375,280,[]],[843173,948,185,378,283,[]],[868148,956,188,382,286,[]],
  [893583,965,190,386,289,[]],[919482,973,193,389,291,[]],[945849,982,195,393,294,[]],
  [972687,991,198,396,297,[]],[1000000,999,200,400,300,[]],
];

// ============================================================
// Prince (サマルトリアの王子) Level Table - 99 levels
// ============================================================
export const PRINCE_LV: LevelTable = [
  [0,18,8,6,6,['hoimi']],[4,34,16,12,11,[]],[27,47,23,16,15,['gira']],
  [82,58,29,21,20,[]],[178,70,36,25,24,['behoimi','sukuruto']],[324,80,42,30,28,[]],
  [531,91,48,34,31,['begirama']],[804,101,54,38,35,['zaoriku']],
  [1154,111,60,42,39,[]],[1585,121,65,46,43,[]],[2107,130,71,50,46,[]],
  [2726,140,77,54,50,[]],[3447,149,82,58,53,[]],[4279,158,88,62,57,[]],
  [5227,168,93,66,60,[]],[6297,177,99,70,64,[]],[7496,186,104,73,67,[]],
  [8829,194,110,77,71,[]],[10302,203,115,81,74,[]],[11921,212,120,85,78,[]],
  [13692,221,126,88,81,[]],[15620,229,131,92,84,[]],[17711,238,136,96,88,[]],
  [19969,246,141,99,91,[]],[22401,255,147,103,95,[]],[25011,263,152,107,98,[]],
  [27805,271,157,110,101,[]],[30787,279,162,114,104,[]],[33964,288,167,117,108,[]],
  [37339,296,172,121,111,[]],[40918,304,178,125,114,[]],[44706,312,183,128,117,[]],
  [48707,320,188,132,121,[]],[52927,328,193,135,124,[]],[57370,336,198,139,127,[]],
  [62040,344,203,142,130,[]],[66943,352,208,146,133,[]],[72083,360,213,149,137,[]],
  [77465,368,218,153,140,[]],[83093,375,223,156,143,[]],[88972,383,228,160,146,[]],
  [95106,391,233,163,149,[]],[101499,399,238,166,152,[]],[108157,406,242,170,156,[]],
  [115083,414,247,173,159,[]],[122282,422,252,177,162,[]],[129758,429,257,180,165,[]],
  [137516,437,262,184,168,[]],[145560,444,267,187,171,[]],[153893,452,272,190,174,[]],
  [162521,459,276,194,177,[]],[171447,467,281,197,180,[]],[180675,474,286,200,184,[]],
  [190210,482,291,204,187,[]],[200057,489,296,207,190,[]],[210217,497,301,211,193,[]],
  [220697,504,305,214,196,[]],[231500,511,310,217,199,[]],[242630,519,315,221,202,[]],
  [254091,526,320,224,205,[]],[265888,533,324,227,208,[]],[278023,541,329,231,211,[]],
  [290501,548,334,234,214,[]],[303326,555,339,237,217,[]],[316501,562,343,240,220,[]],
  [330032,570,348,244,223,[]],[343921,577,353,247,226,[]],[358172,584,357,250,229,[]],
  [372789,591,362,254,232,[]],[387777,598,367,257,235,[]],[403139,605,371,260,238,[]],
  [418878,613,376,263,241,[]],[434998,620,381,267,244,[]],[451504,627,385,270,247,[]],
  [468398,634,390,273,250,[]],[485685,641,395,276,253,[]],[503369,648,399,280,256,[]],
  [521452,655,404,283,259,[]],[539939,662,409,286,262,[]],[558834,669,413,289,265,[]],
  [578139,676,418,293,268,[]],[597860,683,422,296,271,[]],[617998,690,427,299,273,[]],
  [638558,697,432,302,276,[]],[659544,704,436,305,279,[]],[680959,711,441,309,282,[]],
  [702806,718,445,312,285,[]],[725089,725,450,315,288,[]],[747813,732,455,318,291,[]],
  [770979,739,459,321,294,[]],[794592,745,464,325,297,[]],[818656,752,468,328,300,[]],
  [843173,759,473,331,303,[]],[868148,766,477,334,306,[]],[893583,773,482,337,308,[]],
  [919482,780,486,341,311,[]],[945849,786,491,344,314,[]],[972687,793,495,347,317,[]],
  [1000000,800,500,350,320,[]],
];

// ============================================================
// Princess (ムーンブルクの王女) Level Table - 99 levels
// ============================================================
export const PRINCESS_LV: LevelTable = [
  [0,14,12,4,8,['hoimi','rariho']],[4,23,28,7,15,[]],[27,32,41,10,21,['manusa']],
  [82,39,53,13,26,['ruura']],[178,47,64,16,31,['behoimi']],[324,54,75,19,35,['riremito']],
  [531,61,85,21,40,[]],[804,68,96,24,44,['ionazun']],[1154,75,106,27,49,[]],
  [1585,82,116,29,53,['zaoriku']],[2107,89,125,32,57,[]],[2726,96,135,35,61,[]],
  [3447,103,144,37,65,[]],[4279,109,154,40,69,[]],[5227,116,163,43,73,[]],
  [6297,122,172,45,77,[]],[7496,129,181,48,81,[]],[8829,135,190,51,85,[]],
  [10302,142,199,53,89,[]],[11921,148,207,56,93,[]],[13692,154,216,58,97,[]],
  [15620,160,225,61,100,[]],[17711,167,233,64,104,[]],[19969,173,242,66,108,[]],
  [22401,179,250,69,111,[]],[25011,185,259,71,115,[]],[27805,192,267,74,119,[]],
  [30787,198,275,76,122,[]],[33964,204,284,79,126,[]],[37339,210,292,81,129,[]],
  [40918,216,300,84,133,[]],[44706,222,308,86,137,[]],[48707,228,316,89,140,[]],
  [52927,234,324,91,144,[]],[57370,240,332,94,147,[]],[62040,246,340,96,151,[]],
  [66943,252,348,99,154,[]],[72083,258,356,102,157,[]],[77465,264,364,104,161,[]],
  [83093,270,372,107,164,[]],[88972,276,380,109,168,[]],[95106,281,388,112,171,[]],
  [101499,287,395,114,174,[]],[108157,293,403,116,178,[]],[115083,299,411,119,181,[]],
  [122282,305,419,121,184,[]],[129758,311,426,124,188,[]],[137516,316,434,126,191,[]],
  [145560,322,442,129,194,[]],[153893,328,449,131,198,[]],[162521,334,457,134,201,[]],
  [171447,340,464,136,204,[]],[180675,345,472,139,208,[]],[190210,351,479,141,211,[]],
  [200057,357,487,144,214,[]],[210217,362,494,146,217,[]],[220697,368,502,149,221,[]],
  [231500,374,509,151,224,[]],[242630,379,517,153,227,[]],[254091,385,524,156,230,[]],
  [265888,391,531,158,233,[]],[278023,396,539,161,237,[]],[290501,402,546,163,240,[]],
  [303326,408,553,166,243,[]],[316501,413,561,168,246,[]],[330032,419,568,171,249,[]],
  [343921,425,575,173,252,[]],[358172,430,582,175,256,[]],[372789,436,590,178,259,[]],
  [387777,441,597,180,262,[]],[403139,447,604,183,265,[]],[418878,452,611,185,268,[]],
  [434998,458,618,188,271,[]],[451504,464,625,190,274,[]],[468398,469,633,192,277,[]],
  [485685,475,640,195,280,[]],[503369,480,647,197,284,[]],[521452,486,654,200,287,[]],
  [539939,491,661,202,290,[]],[558834,497,668,204,293,[]],[578139,502,675,207,296,[]],
  [597860,508,682,209,299,[]],[617998,513,689,212,302,[]],[638558,519,696,214,305,[]],
  [659544,524,703,216,308,[]],[680959,530,710,219,311,[]],[702806,535,717,221,314,[]],
  [725089,540,724,224,317,[]],[747813,546,731,226,320,[]],[770979,551,738,228,323,[]],
  [794592,557,745,231,326,[]],[818656,562,752,233,329,[]],[843173,568,759,236,332,[]],
  [868148,573,766,238,335,[]],[893583,578,773,240,338,[]],[919482,584,779,243,341,[]],
  [945849,589,786,245,344,[]],[972687,595,793,248,347,[]],[1000000,600,800,250,350,[]],
];

// ============================================================
// LV_TABLES mapping: character id -> level table
// (Legacy characters are added at runtime via LEGACY_CHARS)
// ============================================================
export const LV_TABLES: Record<number, LevelTable> = {
  0: HERO_LV,
  1: PRINCE_LV,
  2: PRINCESS_LV,
};
